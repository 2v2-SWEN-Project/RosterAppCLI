{% extends "layout.html" %}
{% block title %}Clock In / Out — Rostering App{% endblock %}

{% block nav_actions %}
<a href="{{ url_for('index_views.staff_dashboard') }}" class="link">Back to Dashboard</a>
{% endblock %}

{% block content %}
<div class="page-center">
    <section class="card" style="max-width: 500px;">
        <h1 class="card-title">Clock In / Clock Out</h1>
        <p style="margin: 0 0 1.5rem 0; font-size: 0.95rem; color: #cbd5e1; font-weight: 600;">Track your shift start and end times</p>

        {% with messages = get_flashed_messages(with_categories=true) %}
          {% if messages %}
            <ul class="flash-messages">
              {% for category, message in messages %}
                <li class="flash {{ category }}">{{ message }}</li>
              {% endfor %}
            </ul>
          {% endif %}
        {% endwith %}

        {% if shift %}
        <section style="background: #1e293b; border: 2px solid #14b8a6; border-radius: 8px; padding: 1.25rem; margin-bottom: 1.5rem;">
            <h3 style="margin: 0 0 0.75rem 0; color: #14b8a6; font-weight: 700;">Today's Shift</h3>
            <table class="detail-table">
                <tbody>
                <tr><th>Shift Date</th><td>{{ shift.start_time[:10] if shift.start_time else 'N/A' }}</td></tr>
                <tr><th>Assigned Time</th><td>{{ shift.start_time[11:16] if shift.start_time else 'N/A' }} - {{ shift.end_time[11:16] if shift.end_time else 'N/A' }}</td></tr>
                <tr><th>Current Status</th><td>
                    {% if shift.clock_out %}
                        <span style="color: #14b8a6; font-weight: 700;">Completed</span>
                    {% elif shift.clock_in %}
                        <span style="color: #3b82f6; font-weight: 700;">Started</span>
                    {% else %}
                        <span style="color: #f59e0b; font-weight: 700;">Not Started</span>
                    {% endif %}
                </td></tr>
                </tbody>
            </table>
        </section>

        <section style="background: #1e293b; border-left: 4px solid #3b82f6; border-radius: 4px; padding: 1rem; margin-bottom: 1.5rem;">
            <h3 style="margin: 0 0 0.75rem 0; color: #3b82f6; font-weight: 700;">Today's Record</h3>
            <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 1rem; font-weight: 600;">
                <div>
                    <p style="margin: 0 0 0.25rem 0; color: #cbd5e1; font-size: 0.85rem; text-transform: uppercase;">Clock In Time</p>
                    <p style="margin: 0; color: #3b82f6; font-size: 1.2rem;">{% if shift.clock_in %}{{ shift.clock_in[11:19] }}{% else %}—{% endif %}</p>
                </div>
                <div>
                    <p style="margin: 0 0 0.25rem 0; color: #cbd5e1; font-size: 0.85rem; text-transform: uppercase;">Clock Out Time</p>
                    <p style="margin: 0; color: #3b82f6; font-size: 1.2rem;">{% if shift.clock_out %}{{ shift.clock_out[11:19] }}{% else %}—{% endif %}</p>
                </div>
            </div>
        </section>

        <form method="post" action="{{ url_for('index_views.staff_clock') }}">
            <input type="hidden" name="shift_id" value="{{ shift.id }}">
            <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 1rem; margin-bottom: 1.5rem;">
                <button type="submit" name="action" value="clock_in" class="btn primary" style="padding: 0.75rem 1rem; font-size: 1rem;" {% if shift.clock_in %}disabled style="opacity: 0.5; cursor: not-allowed; padding: 0.75rem 1rem; font-size: 1rem;"{% endif %}>
                    Clock In
                </button>
                <button type="submit" name="action" value="clock_out" class="btn success" style="padding: 0.75rem 1rem; font-size: 1rem;" {% if not shift.clock_in or shift.clock_out %}disabled style="opacity: 0.5; cursor: not-allowed; padding: 0.75rem 1rem; font-size: 1rem;"{% endif %}>
                    Clock Out
                </button>
            </div>
        </form>
        {% else %}
        <section style="background: #1e293b; border: 2px solid #14b8a6; border-radius: 8px; padding: 1.5rem; text-align: center;">
            <h3 style="margin: 0 0 0.75rem 0; color: #14b8a6; font-weight: 700;">Shift Information</h3>
            <p style="margin: 0; font-size: 1rem; color: #cbd5e1; font-weight: 600;">You currently have no shifts assigned.</p>
            <p style="margin: 0.5rem 0 0 0; font-size: 0.9rem; color: #94a3b8;">Contact your administrator to request shift assignments.</p>
        </section>
        {% endif %}

        <section style="background: #1e293b; border-left: 4px solid #f59e0b; border-radius: 4px; padding: 1rem; margin-top: 1.5rem;">
            <p style="margin: 0; font-size: 0.9rem; color: #fbbf24; font-weight: 700;">Please ensure you clock in when you arrive and clock out when you leave. Accurate records are important for payroll and scheduling.</p>
        </section>
    </section>
</div>

<style>
.detail-table {
    width: 100%;
    border-collapse: collapse;
    font-size: 0.9rem;
    font-weight: 600;
}

.detail-table th {
    text-align: left;
    padding: 0.35rem 0.6rem;
    width: 40%;
    background: transparent;
    border-bottom: 2px solid #14b8a6;
    color: #14b8a6;
    font-weight: 700;
}

.detail-table td {
    padding: 0.35rem 0.6rem;
    border-bottom: 1px solid #334155;
    color: #14b8a6;
}
</style>
{% endblock %}
